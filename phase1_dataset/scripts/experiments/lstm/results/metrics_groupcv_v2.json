{
  "model": "packed_attn_bilstm_v2",
  "dataset": "final\\phase1_dataset.jsonl",
  "seed": 9,
  "folds": 5,
  "grouping": {
    "rule": "phish paraphrase\u2192base_msg_id else\u2192msg_id",
    "n_groups_total": 240
  },
  "training_rule": "train on legit + phishing originals only",
  "conditions": {
    "A": "test on legit + phishing originals",
    "B": "test on legit + phishing paraphrases"
  },
  "aggregate": {
    "A_f1": {
      "mean": 0.9283090109309219,
      "std": 0.04421273003260513
    },
    "B_f1": {
      "mean": 0.9619842803638468,
      "std": 0.021820333867715806
    },
    "A_recall": {
      "mean": 0.9166666666666666,
      "std": 0.05103103630798288
    },
    "B_recall": {
      "mean": 0.9383333333333332,
      "std": 0.04433145359423458
    },
    "delta_f1": {
      "mean": -0.03367526943292487,
      "std": 0.04085350549208714
    },
    "delta_recall": {
      "mean": -0.021666666666666657,
      "std": 0.038005847503304595
    }
  },
  "fold_results": [
    {
      "fold": 1,
      "n_groups_train": 192,
      "n_groups_test": 48,
      "n_train_rows": 192,
      "n_testA_rows": 48,
      "n_testB_rows": 144,
      "condition_A": {
        "accuracy": 0.8958333333333334,
        "precision": 0.88,
        "recall": 0.9166666666666666,
        "f1": 0.8979591836734694,
        "confusion_matrix": [
          [
            21,
            3
          ],
          [
            2,
            22
          ]
        ]
      },
      "condition_B": {
        "accuracy": 0.9583333333333334,
        "precision": 0.975,
        "recall": 0.975,
        "f1": 0.975,
        "confusion_matrix": [
          [
            21,
            3
          ],
          [
            3,
            117
          ]
        ]
      },
      "delta_f1": -0.07704081632653059,
      "delta_recall": -0.05833333333333335,
      "model_cfg": {
        "vocab_size": 20000,
        "min_freq": 2,
        "max_len": 256,
        "embed_dim": 96,
        "hidden_size": 96,
        "num_layers": 2,
        "attn_heads": 4,
        "dropout": 0.25,
        "lr": 0.002,
        "weight_decay": 0.01,
        "batch_size": 16,
        "epochs": 12,
        "patience": 3,
        "grad_clip": 1.0
      },
      "train_info": {
        "vocab_final": 859,
        "best_val_loss": 0.0019391274933392804
      },
      "device": "cuda"
    },
    {
      "fold": 2,
      "n_groups_train": 192,
      "n_groups_test": 48,
      "n_train_rows": 192,
      "n_testA_rows": 48,
      "n_testB_rows": 144,
      "condition_A": {
        "accuracy": 0.875,
        "precision": 0.9090909090909091,
        "recall": 0.8333333333333334,
        "f1": 0.8695652173913043,
        "confusion_matrix": [
          [
            22,
            2
          ],
          [
            4,
            20
          ]
        ]
      },
      "condition_B": {
        "accuracy": 0.8958333333333334,
        "precision": 0.981651376146789,
        "recall": 0.8916666666666667,
        "f1": 0.9344978165938864,
        "confusion_matrix": [
          [
            22,
            2
          ],
          [
            13,
            107
          ]
        ]
      },
      "delta_f1": -0.0649325992025821,
      "delta_recall": -0.05833333333333335,
      "model_cfg": {
        "vocab_size": 20000,
        "min_freq": 2,
        "max_len": 256,
        "embed_dim": 96,
        "hidden_size": 96,
        "num_layers": 2,
        "attn_heads": 4,
        "dropout": 0.25,
        "lr": 0.002,
        "weight_decay": 0.01,
        "batch_size": 16,
        "epochs": 12,
        "patience": 3,
        "grad_clip": 1.0
      },
      "train_info": {
        "vocab_final": 859,
        "best_val_loss": 0.013837337493896484
      },
      "device": "cuda"
    },
    {
      "fold": 3,
      "n_groups_train": 192,
      "n_groups_test": 48,
      "n_train_rows": 192,
      "n_testA_rows": 48,
      "n_testB_rows": 144,
      "condition_A": {
        "accuracy": 0.9375,
        "precision": 0.92,
        "recall": 0.9583333333333334,
        "f1": 0.9387755102040817,
        "confusion_matrix": [
          [
            22,
            2
          ],
          [
            1,
            23
          ]
        ]
      },
      "condition_B": {
        "accuracy": 0.9722222222222222,
        "precision": 0.9833333333333333,
        "recall": 0.9833333333333333,
        "f1": 0.9833333333333333,
        "confusion_matrix": [
          [
            22,
            2
          ],
          [
            2,
            118
          ]
        ]
      },
      "delta_f1": -0.044557823129251606,
      "delta_recall": -0.02499999999999991,
      "model_cfg": {
        "vocab_size": 20000,
        "min_freq": 2,
        "max_len": 256,
        "embed_dim": 96,
        "hidden_size": 96,
        "num_layers": 2,
        "attn_heads": 4,
        "dropout": 0.25,
        "lr": 0.002,
        "weight_decay": 0.01,
        "batch_size": 16,
        "epochs": 12,
        "patience": 3,
        "grad_clip": 1.0
      },
      "train_info": {
        "vocab_final": 871,
        "best_val_loss": 0.040505907187859215
      },
      "device": "cuda"
    },
    {
      "fold": 4,
      "n_groups_train": 192,
      "n_groups_test": 48,
      "n_train_rows": 192,
      "n_testA_rows": 48,
      "n_testB_rows": 144,
      "condition_A": {
        "accuracy": 0.9583333333333334,
        "precision": 1.0,
        "recall": 0.9166666666666666,
        "f1": 0.9565217391304348,
        "confusion_matrix": [
          [
            24,
            0
          ],
          [
            2,
            22
          ]
        ]
      },
      "condition_B": {
        "accuracy": 0.9097222222222222,
        "precision": 1.0,
        "recall": 0.8916666666666667,
        "f1": 0.9427312775330396,
        "confusion_matrix": [
          [
            24,
            0
          ],
          [
            13,
            107
          ]
        ]
      },
      "delta_f1": 0.013790461597395165,
      "delta_recall": 0.02499999999999991,
      "model_cfg": {
        "vocab_size": 20000,
        "min_freq": 2,
        "max_len": 256,
        "embed_dim": 96,
        "hidden_size": 96,
        "num_layers": 2,
        "attn_heads": 4,
        "dropout": 0.25,
        "lr": 0.002,
        "weight_decay": 0.01,
        "batch_size": 16,
        "epochs": 12,
        "patience": 3,
        "grad_clip": 1.0
      },
      "train_info": {
        "vocab_final": 878,
        "best_val_loss": 0.1687546775986751
      },
      "device": "cuda"
    },
    {
      "fold": 5,
      "n_groups_train": 192,
      "n_groups_test": 48,
      "n_train_rows": 192,
      "n_testA_rows": 48,
      "n_testB_rows": 144,
      "condition_A": {
        "accuracy": 0.9791666666666666,
        "precision": 1.0,
        "recall": 0.9583333333333334,
        "f1": 0.9787234042553191,
        "confusion_matrix": [
          [
            24,
            0
          ],
          [
            1,
            23
          ]
        ]
      },
      "condition_B": {
        "accuracy": 0.9583333333333334,
        "precision": 1.0,
        "recall": 0.95,
        "f1": 0.9743589743589743,
        "confusion_matrix": [
          [
            24,
            0
          ],
          [
            6,
            114
          ]
        ]
      },
      "delta_f1": 0.004364429896344779,
      "delta_recall": 0.008333333333333415,
      "model_cfg": {
        "vocab_size": 20000,
        "min_freq": 2,
        "max_len": 256,
        "embed_dim": 96,
        "hidden_size": 96,
        "num_layers": 2,
        "attn_heads": 4,
        "dropout": 0.25,
        "lr": 0.002,
        "weight_decay": 0.01,
        "batch_size": 16,
        "epochs": 12,
        "patience": 3,
        "grad_clip": 1.0
      },
      "train_info": {
        "vocab_final": 861,
        "best_val_loss": 0.0008131071226671338
      },
      "device": "cuda"
    }
  ]
}